How does the authentication system work? What pattern does it use?